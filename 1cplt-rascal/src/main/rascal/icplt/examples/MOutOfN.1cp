role @prod(ok: boolean) {
  main:
    self -> @cons.p |>
      if
        ps.length < m
      then
        ps := [p].concat(ps) ;
        true -> p.ok
      else
        false -> p.ok
}

role @cons(p?: @prod, ps: @prod[], m: number)

process @prod[1](false)
process @prod[2](false)
process @prod[3](false)
process @cons(undefined, [], 2)

#analyze
#compile
#execute
