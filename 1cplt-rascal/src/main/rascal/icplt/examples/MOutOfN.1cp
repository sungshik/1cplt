role @prod(ok: boolean = false) {
  main:
    self -> @cons.p |>
      if
        ps.length < m
      then
        ps := [p].concat(ps) ;
        true -> p.ok
      else
        false -> p.ok
}

role @cons(m: number, p?: @prod, ps: @prod[] = [])

process @prod[1]()
process @prod[2]()
process @prod[3]()
process @cons(m = 2)

#analyze
#compile
#execute
